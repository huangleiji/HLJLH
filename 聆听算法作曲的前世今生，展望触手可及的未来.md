#第一章   现在

#### 音乐剧《Beyond the Fence 》是第一部由计算机与人牵手合作的歌剧，其中，人类承担着编舞、演出、剧务，而电脑程序则负责构思和生成剧本、歌词以及音乐的大部分材料，最后再交付给人类挑选和整理成定稿。你有所不知，整个项目是由音乐、计算机、创造力研究领域的顶尖专家协作而成的一个学术计划。此时此刻，该项目正被天空艺术公司（Sky Arts）摄制为“电脑说秀”（ Computer Says Show）纪录片中的剧集，这是多么难得的机会，为我们了解算法技术参与艺术创作的全过程拉开了序幕。
#### 其实，算法作曲(algorithmic Composition)，或称自动作曲(automated composition)并不新奇，早在1957年，化学家/音乐家Lejaren Hiller使用算法生成了弦乐四重奏伊利亚组曲（Illiac Suite），其后，David Cope教授的Emily Howell系统也随即名声大噪。不过，写一出音乐剧可比写一首曲子复杂得多，其中最重要的成功诀窍在于——剑桥大学的机器学习小组基于大数据分析，建立出音乐剧的成功诀窍模型和预测系统。该小组先是对戏剧中的角色规模、背景信息、情感结构和经典主题、剧目企划、工序、故事、音乐和歌词等一系列因素进行探讨和权重分析，然后归纳出音乐剧的成功模式、法则，最后从理论上进行优化。基于此原理，科学家们将整个项目的初创部分拆分为几个步骤。

## 1 剧情主旨分析
##### 主创团队与伦敦大学金匠学院的“What-If Machine”项目团队合作，将上述研究模型推导出的“关键成功因素”输入“What-If Machine”，产生算法创意联想，从而获得由多个电脑生成的构思，涉及音乐剧的主题、关键性角色的设定信息等。最终由人类团队筛选并确定整部音乐剧的主旨：

##### **What if a wounded soldier had to learn how to understand a child in order to find true love? **
如果一名受伤的士兵需要学习体会一个孩子的内心，才能找到真爱，会是什么情况？

>##### “what if machine”是由五所机构联合研发。这个系统可以根据一定的素材类别和给定的关键词生成一个虚构的想法，并采用人工智能评估结合人类评估打分的手段，判断所生成想法的现实文化价值，进而不断优化系统的生成效果。
>##### 这个系统的大致工作流程是这样的：首先，针对某个领域收集并分析信息，进而形成初步世界观；其次，通过对语义的分析，理解和框定语言张力的构成模式，由此，系统得以使用带来紧张、不协调的奇怪概念和一些既定的关联性句法来生成虚构的想法。比如：
> - 要是动物说的是宇宙语那怎么办？
> -  要是猫有自己的互联网那会怎么样
>
##### 再次，在整个创意过程中，通过机器学习、数据挖掘和自动监察，给予生成的创意越来越接近于人类真实想法的反馈，进而评估、分级以及预测性地选择创意；最后，加载语义学、核心观念、基于效果的加工方式、模糊算法和想法扩充等功能，使得无论是人还是机器产生的创意，都能发挥出最好的效果。


>##### 从本质上来说，这个系统是一个能拓宽人的认识维度，获得意想不到的观察角度的工具。简单来说，很多时候你玩艺术都是先有想法，再借助外部手段（比如画画、小说、广告语等等）表达出来，那么这样一个能够激发你产生核心想法并且能进一步衍生、探究、评估以及提供利用建议的程序就存在明显的实用价值了。




## 2 故事结构生成
##### 这部音乐剧的情节也由算法生成。马德里康普顿斯大学的帕布罗·格瓦斯教授（Prof.Pablo Gervás） 开发了一套名为“PropperWryter”的故事生成系统，这套系统采用机器学习技术，分析以往音乐剧的叙事线索与技巧，随后根据分析反馈反复调试，最终确立了这部作品的核心叙事形式。

>##### PropperWryter以抽象情节元素为单元，与人物行为一一映射，比如“男孩遇见女孩”，“男孩失去了女孩”，“恶棍绑架受害者”，“英雄营救受害者”。

####系统还可以在给定的规则基础上，自动生成形成完整故事的情节元素，比如上例中的情节单元就可以构架出一个逻辑闭环的故事框架。系统还能识别情绪词汇，比如，它知道某个情节单元是难过的或是快乐的，知道添加一个情节单元以增强戏剧张力，知道解决情节中所有的矛盾冲突是一部完整故事的基础。

## 3 确定剧本与歌词
##### 在前面各个环节的基础上，整个音乐剧故事的框架浮出水面。作曲家Benjamin Till以及剧作家兼演员Nathan Taylor书写剧本并依据剧本创作歌词，附加歌词则是由THE CLOUD LYRICIST（由Dr. JAMES ROBERT LLOYD与Dr. ALEX DAVIES共同训练制作的递归神经网络系统）创作。


>##### 作曲家Benjamin Till以及剧作家兼演员Nathan Taylor是剧本、词曲以及编曲的主要整理、定稿者。他们是活跃在英国文艺界的一对同性恋夫夫。Benjamin20多年来投身于无独白音乐剧记录片创作，获得诸多一流奖项及提名；Nathan则参演了众多西区剧院的戏剧演出，作为剧作家，他近期最令人关注的作品是和作曲家Benjamin Till联合作曲作词的音乐剧《我们的同性恋婚礼》。这部音乐剧获得“英国电影学院奖”(BAFTA Awards)最佳音乐/词作提名，也使他本人与Benjamin Till的婚姻成了头条。


## 4 音乐整理编制
##### 音乐剧所使用的大部分音乐材料由杜伦大学的尼可科林斯博士（Dr.NICK COLLINS）提供，他创造了一套音乐创作系统，这套系统采用机器学习技术，自动分析音乐剧作品，并以著名音乐剧作曲家安德鲁·洛伊德·韦伯(AndrewLloydWebber)的名字命名。其余的音乐材料，则通过索尼公司中位于巴黎的计算机科学实验室(SonyCSL, Paris)的两位领衔者皮埃尔·罗伊博士（Dr Pierre Roy） 和弗朗索瓦·帕谢博士（Dr Francois Pachet ）所提供的flowcomposer辅助作曲系统生成。然后再由作曲家本杰明·提尔（Benjamin Till）以及剧作家兼演员内森·泰勒（Nathan Taylor）策划统筹、整理与编排。
##### 尔后，几所参与院校的学生与工作人员整理乐谱并交给参演人员作排练之用。
>##### flowcomposer从属于Flow-Machines 项目组（欧洲研究理事会资金资助项目）。这个项目，就目前笔者所知而言，属最高水准之列，而且其精准的定位和专业的观念层次，预示着其商业上的可能性。

>##### Flow-Machines项目的目标是创造新一代的创作工具（通过“反身性互动”的概念）以提高个体的创造力。比如，针对文本和音乐创作，它能帮助用户模仿特定风格的作品（包括用户自己的），并添加一些个人偏好倾向的规则以产生新的风格，还能帮助创作者调谐、融合不同的风格，以创造新风格。进一步的，整个系统还能通过记录使用者的使用过程、记录软件与创作者之间的互动及其如何影响其创造力等数据，从而不断完善程序。在flowcomposer等程序中，用户还能通过反向学习，从生成的作品中观察其工作方式和引用的素材来源、组织方式，学习音乐创作的模式与法则，这将增加将软件用于教学的可能性。
>##### 它包括一组程序：flowcomposer（旋律及和声同步创作）、flowharmonizer（和声分析与协调）、ode to joy（风格融合）、Palindromes（回文生成）、Virtuoso system（基于马尔科夫链的即兴演奏系统）及音乐乐谱在线编辑系统lead sheet系列等等，从文本、音乐作品中识别特征和提取本质的构件、要素单元，并将其转化为创作的素材。这些程序的应用范围包括作曲、文本、图形的生成等等。


## 5 作品整合评估
##### 在前面各项要素生成的基础上，整个音乐剧的剧本、音乐、歌词被重新评估，而评估者，正是一开始剑桥大学机器学习小组开发的音乐剧成败预测分析和大数据统计分析系统。这些部分被反复精心调试，力图呈现出涵盖所有音乐剧成功因素的崭新作品。

##### “像一杯清淡无害、可口的热牛奶”是这部音乐剧上演以来所获得的最好的评价。同时，被一直强调的“成功诀窍模型”也因全剧中“充满愉快的中间派的歌曲段落”的做法略显老套，而被某些人诟病。事实上，市场调查的做法实属寻常，至今已经有超过700部音乐剧上映之前曾通过各种方式收集受众需求以保障商业利益。而且，在短期内，观众对计算机涉足艺术领域依旧存在偏见。这样一来，普遍的评价就显得温和多了，毕竟，如果没有人类，音乐剧怎么演？

#第二章   过去

#####回顾历史，展望未来。音乐发展至今，所有的创新和突破都在竭尽所能地挑战人类极限，历代西方作曲大师无不在伟大作品中留下探索音乐与新技术融合之道的时代印记。是时候回到过去，看看我们的先辈在算法与音乐上具体都做了什么，才好知道自己的起点和方向在哪，也才好张开怀抱，面对这个令人不安的未来。

##1 数与音乐

#####在悠悠历史的长河中，近千百年来，有很多著名的科学家诸如毕达哥拉斯、翰尼斯·开普勒 、伽利略 、莱昂哈德 · 欧拉 、让·巴普蒂斯 · 约瑟夫 · 傅立叶、哈代等人都曾研究过音乐与数学之间的关系。数学，其英是“mathematics”，这是个复数名词。在古代欧洲，数学曾经是由四门学科组成的：算术、几何、天文学和音乐。音乐虽然在表象上是流动音响的时间艺术，然而，从其基础理论设计与数学逻辑同构并进行符号化组织的角度来看，似乎没有任何一门艺术，天生能比音乐拥有更强的可计算性，1973年分形理论的提出，更让人们了然了这一点。另外，作为有趣的佐证，神童常见于数学、音乐、象棋这样的领域，也许正是因为他们主要依靠对封闭的抽象逻辑世界的超常的领悟，而不是一般世界的经验。在音乐中，个体的技术成熟与生活经验之间并无太大关系，而文学、生物等其他领域的大师则需要相对更长的成长周期。

#####算法是阿拉伯数字的运算法则。对音乐创作而言，广义的算法指音乐要素及组织逻辑、运算法则、结构模型或规则系统，以及将算法思维与作曲思维中最小的决策单位对应后所形成的作曲技法模型与系列，也就是音乐的数理逻辑。这种对应关系一言以蔽之：凡作曲即有算法。如旋律的动机展开、重复、模进、转调、逆行、倒影、随机、模糊、音程或节奏压扩,和声与对位中的音高纵横向排列组合、不谐和度、紧张度解决,配器中的音色组合,曲式中的并行、对置、对称、回旋、奏鸣等等原则都属于常规的作曲技法,都可以被描述为单一或组合的算法。

##2 使用算法的传统音乐创作
#####伴随着具有均匀节奏的圣歌，15世纪的时候，算法系统就开始使用节奏模式作曲。随后在文艺复兴时期以及巴洛克时代，作曲技法不断的完善，作曲家为旋律的对位发展了严格的规则。例如:复调音乐的创作几乎完全可以通过使用诸如倒影、主题加花或简化等这样系统化的过程来发展某一给定的主题动机(一个音乐小片段)，赋格曲就好像音乐中的纯逻辑，可以说最精炼地表述了符号编码的一般秩序。在古典时期,莫扎特在创作“Musical Dice Game”的时候,就是运用了随机方式来组合模块作曲。在这部作品中,他创作了176小节音乐,然后将小节号排列为两个特殊的矩阵图,通过演奏家掷般子的方式来决定演奏的顺序。也许，将算法应用于音乐的愿望可能和音乐本身一样古老。
￼￼
#####音乐创作的形式化技术在20世纪初再一次发展，勋伯格引入了十二音技术，而后由韦伯恩和继承者们对此作了进一步的发展。在20世纪50年代初的时候，算法作曲家泽纳基斯(Iannis Xenakis)就利用随机过程生成音乐片段。在50年代至70年代这个时期,由于受到当时计算工具的限制，仅可运算简单的加/减法。当时的算法作曲多属于观念实验性质，这些算法音乐作品以数理逻辑作为作品结构基础而甚少诉诸于听觉，需要具有一定的数学逻辑思维的人才能创作。

##3 当代算法作曲——自动作曲技术历史溯源
#####狭义上的算法作曲，可以简单地形容为计算机自动作曲系统，在人适当的介入下,计算机就能自动生成音乐。在这里，我主要陈述自动作曲技术的发展节点，而不涉及西方电子音乐历史的两次浪潮。
###3.1
#####1957年，由列哈伦·希勒（Lejaren Hiller）和里奥纳德·艾撒克逊（Leonard Isaacson）出版的弦乐四重奏Illiac组曲成为史上最先完全由计算机生成的音乐作品。他们基于产生——测试的方法创作，首先使用 Markov链模型来产生有限控制的随机音符，之后利用和声与复调的规则测试这些音符，最后选择符合规则的材料，修改、组合成传统音乐记谱的弦乐四重奏。
#####1960年，俄罗斯研究者R.Kh.Zaripov发行了全世界第一篇关于用“Ural-1”计算机进行算法音乐作曲的论文。
#####1965年，发明家Ray Kurzweil首次公演了一首用计算机来创作的钢琴作品，这台计算机能够对各种不同的乐曲进行模式识别，并且可以分析和使用这些模式去创造新的旋律。
#####1974年第一次国际计算机音乐会议召开（ICMC）......
#####随着计算机相关技术的发展和普及，越来越多的人关注到这个科技与艺术奇妙结合的领域，于是在那个新生流派争奇斗艳的先锋实验年代，各式各样的作曲算法涌现出来。然而直到1987年，美国作曲家大卫·科普( David Cope) 开发的“音乐智能实验”系统( Experiments in Musical Intelligence,简称 EMI，)第一次在国际计算机音乐年会上公开展示初期成果时起，计算机音乐与传统音乐之间的桥梁才逐渐被架设起来。
###3.2
#####EMI（采用Lisp语言）能够以极高的效率和相当的效果模仿上百位作曲家的风格，需要强调的是，能被系统模仿的要素主要集中在旋律、和声、乐曲结构和部分简单的乐器组合规律上，诸如类似巴赫的众赞歌、莫扎特的奏鸣曲以及肖邦的夜曲等。其中最深层次的原理被 Cope 称作“重组 (recombinant )”，当然，简单地把音乐成分拆解并随机重组是注定失败的。有效的重组必须以大量的音乐分析为基础，获得清晰的风格定义，再小心翼翼地选取不损伤音乐性的最基本的风格标签元素为单位进行重组，依此产生一份“同样风格下的”新作品。比如,cope选择莫扎特奏鸣曲风格的一系列原作输入给 EMI 系统作为分析的“数据库”,EMI通过程序分析、解构这些作品，识别作曲家的创作特征，提炼为音乐风格的“DNA”，作为创作的依据，最终生成多个莫扎特风格的新作品乐谱，再由cope甄选、修改。
#####cope在这项实验上延续的改进工作长达三十年。二十世纪九十年代，cope不再满足只生成仿作的系统，而力图让计算机程序创造出属于它自己的音乐风格，同时也用这种方式回应那些被他的成果所激怒和心生恐惧的人们（侯世达-Hofstadter曾著文《如聆巴赫》表达过对此的感受）。于是，建立在EMI分析数据库基础上的EMILY HOWELL系统诞生了。这套系统完善了人机交互反馈环节，使得无论是自然语言指令还是输入音符修改方案，都能有效改善EMILY的算法，使其的进化更符合作者和听众的预期。这个系统的源码是以专著形式公开的，并且，据传EMILY已经接受商业订单了。
￼
##4 当代算法作曲——自动作曲技术及主流软件
#####目前在自动作曲中公认的有影响的技术主要有马尔科夫链、随机过程、基于规则的知识库系统、音乐语法、人工神经网络、遗传算法，其他出现的技术有分层结构、细胞自动机理论、基于经验的作曲、回答集编程、可能性构造空间思维模型、概率逻辑、三元脑模型等等。这些技术在当时基本上都紧密地跟进了计算机技术的发展潮流。
#####近半个世纪以来，基于上述技术开发的软件平台数不胜数，这里是一些常见的主流软件：音响合成的有Csound，以及在此基础上的扩展软件有Orchestration、Ceeilia等；利用图形、文本等其它媒体数据生成音乐的软件有Music Generater；通过搭建各种小的算法物件而生成音乐的软件Max/MSp、Infinity、Algorithmic Composer等；利用频谱学派技术来创作音乐的软件Open Music； 可以生成为帕拉斯特里拉风格的严格对位音乐的williamShottstaedt的自动对位程序等；基于规则与音乐文法，可续写、仿写传统作曲家风格的EMI/EMILY HOWELL系统、Longuet-Higgin系列全音程和声Jazz作曲系统；还有集多种算法作曲技法为一体的技术混合型系统的开发方向，如HARMONET+MELONET混合系统、国内自主开发的Sound in a System等等；在后续的发展中，这几类软件的功能又有相互渗透的趋势，并且人机交互功能也不断成熟。不过，这些依托不同理论和逻辑层次解决特定问题的程序设计思路，具有阶段性的现实意义，所以它们仍然具有各自的不可替代性。这里简要讨论一下。

###4.1
#####基于随机过程、概率逻辑的有限控制方法，尤其是使用马尔科夫链结合一定约束规则，在统计的基础上对音乐的未来走向进行概率预测与风格边界限制，音乐旋律的很多风格特性都与所采用的音阶、节奏有关，限制了可使用的音的范围、出现概率与节奏组合形态，也在一定程度上划定了风格的边界。因它们建模简单，可以即时产生新音乐，所以一直被广泛用于商业程序上，也大量出现在互动音乐艺术家诸如Jefrrey Stolet、Francois Pachet等人的作品和即兴演出中。

###4.2
#####同样基于随机过程的有限控制，遗传算法、细胞自动机理论、分层结构（借鉴混沌/分形理论）等技术，都是在不同层面上寻找最优解、拟合。这些技术的特性更适合于以检验作品而不是以生成作品的形式加入到作曲系统之中使用。具体地说，这些技术背后的理论都从机制的层面去研读客观世界，能够很好地解释现象、提取共性模式与法则，然而客观世界是超越还原论的复杂系统，单纯根据这些理论模型无法还原现象。更进一步地说，根据这些理论设计的几种技术，就目前而言，并不能有效反映实际音乐作品中构成元素在时空维度上的秩序感与复杂关系，并且，从实用的角度考虑，以往实践所选择的算法与音乐元素之间的映射关系也有待商榷。应用这些技术时，通过人机交互不断提供反馈及修改规则，可以在一定程度上提升所生成作品的质量，即使效果不大理想。有研究者认为，这是因为现有算法与作曲家的思维模式相异而导致的，而我觉得，我们其实无需画地为牢，囿于人类作曲的思维模式，我们需要的是把握最终生成的音响，令其符合人的音乐听觉认知/神经/心理/生理基础即可，毕竟人类对音乐作品中占据显著位置的音高和节奏模式宽容度有限。从使用方式上着手，对这些作曲系统另辟蹊径，倒是可以柳暗花明。

###4.3
#####基于经验的作曲、基于规则的知识库系统、音乐语法、可能性构造空间思维模型等技术，重在从模式和法则层面分析音乐创作思维、音乐作品，基本属于模仿性质的技术。这些技术或通过输入已有作品，或纯粹基于设定的规则来生成作品。基于规则的做法需要对音乐如何产生、音符句法张力如何运作、旋律单元如何组合成乐句和段落有极其深入的理解，显然，没有一套规则可以简单地诠释音乐，所以基于已有作品分析基础上的规则控制技术较为成功（比如EMI系统），且这种技术也最实用，商业应用最广泛。

###4.4
#####属于人工智能研究范畴的机器学习技术（包含自动推理、早期几种人工神经网络算法等），核心是回归和数据拟合。或许不少人会记得机器学习的第一个成功案例：IBM启动的“老实人”（Candide）自动翻译项目。“老实人”把“理解一个复杂过程”这个问题转换为“从大规模这一过程运作的实例中构建浅层规律模型，并依此对未知数据进行预测”。这些系统得到的有效数据与反馈越多，翻译任务完成得越好，但是因为不涉及价值和策略判断，也缺乏更深层次的信息特征识别，这类系统在随数据量而改善达到一定程度时，边际效益递减也很明显。使用机器学习技术的自动作曲系统目前属于这个领域的最前沿，上文中提及的flowmachine就属此类（尚未知晓其具体算法构成）。
####事实上，自动作曲系统所服务的领域并不狭隘，但是由于其交互界面简陋，对功能的调用又大多要求编程基础和音乐理论修养，其服务的人群一直以研究型机构、专业作曲家、新媒体互动艺术家群体为主。同时，这些技术侧重于研究意义，作品面向的对象往往不够明确，这种应用上的不迫切，某种程度上也阻碍了这些技术的进步。近年来，随着开放科学的兴起，许多基于机器学习、神经网络的开源项目浮出水面，整个领域开始进入快速发展。

##5 算法作曲的消费级应用——计算机辅助作曲系统
#####我感兴趣的是算法作曲技术的实用性道路，因为最终无论在台式电脑、专业的一体式硬件，还是在平板、手机上，你都可以轻松使用，这些工具为创作和教育带来了无比的便利。下面简要提及一些台式电脑的主流软件，你感兴趣的话可以通过文末提供的文献链接延伸阅读，进一步了解。

###台式电脑音乐制作
#####宿主软件：主要有cubase、nuendo、sonar、logic、FL studio、Pro Tools。当前发展的趋势是all in one，功能涵盖面广，通过包括虚拟乐器插件、合成器、采样器、各种算法外部插件，可获得极大的性能扩展。这些专业软件整合了大量专家的工作习惯，使用者在熟悉其高阶操作方式后，工作效率将获得很大提升。
#####制谱软件：Finale、Siblius。除了制谱的主要功能之外，也可以通过各种插件获得性能扩展，其内置功能包括了许多自动作曲算法如自动配器、根据音乐动机自动构思等等。
#####自动伴奏软件：band in a box。流行音乐基本上是模块化、确定性中带少量偶发随机信息的思维，乐器组合、节奏、phrase（习语）、voicing（和弦构成）、licks（标签性质旋律片段）、riff（连续反复的旋律性伴奏型）等元素被作为模板确定下来之后，整个风格就基本可以被确立。这个软件最大的优势就在于风格模板库全面，无论作为研读风格的最小模型，还是用于试验风格重组以形成新风格，都相当便利。特别是对于带有即兴成分的爵士类音乐，band in a box 还提供将solo（独奏）乐器的licks自动重组衔接的算法，对于当代教学与探索有一定意义。

